{% load static %} 
<!DOCTYPE HTML>
<html>

<head>
    <title>{{ titulo_pagina }}</title>
    <link rel="stylesheet" href="../../static/style.css"></head>
    <link rel="icon" type="image/png" href="{% static 'SuperLogo.png' %}">


<body>
    <h2>{{ titulo_pagina }}</h2>
    
    {% if superheroes %}
        <p>Haga clic en 'Ver Detalles' para cargar la información con AJAX.</p>
        <ul id="superheroe-lista">
            {% for heroe in superheroes %}
                <li>
                    {% if heroe.foto %} 
                        <img src="{{ heroe.foto.url|default_if_none:'' }}" alt="Foto de {{ heroe.nombre }}" width="75" style="vertical-align: middle;">
                        &nbsp;
                    {% endif %}
                    
                    <strong>{{ heroe.nombre }}</strong> 
                    
                    <button onclick="cargarDetalles('{{ heroe.id }}')" data-heroe-id="{{ heroe.id }}">
                        Ver Detalles 
                    </button>
                    
                    <div id="detalles-{{ heroe.id }}" style="margin-left: 20px; border: 1px solid #ccc; padding: 5px; display: none;">
                        Cargando...
                    </div>
                </li>
            {% endfor %}
        </ul>
    {% else %}
        <p>No hay superhéroes registrados.</p>
    {% endif %}

    <p>
        <a href="{% url 'admin:index' %}">Ir al Panel de Administración</a>
    </p>

    <script>
        function cargarDetalles(heroeId) {
            const detallesDiv = document.getElementById(`detalles-${heroeId}`);
            const url = `/WikiApp/api/superheroes/${heroeId}/`; 

            // Lógica de AJAX (la misma que tenías antes)
            if (detallesDiv.style.display === 'block') {
                detallesDiv.style.display = 'none';
                return;
            }
            detallesDiv.style.display = 'block';
            detallesDiv.innerHTML = 'Cargando datos con AJAX...';

            fetch(url)
                .then(response => {
                    if (!response.ok) {
                        throw new Error(`HTTP error! status: ${response.status}`);
                    }
                    return response.json();
                })
                .then(data => {
                    detallesDiv.innerHTML = `
                        <p><strong>Poderes:</strong> ${data.poderes}</p>
                        <p><strong>Nacimiento:</strong> ${data.nacimiento}</p>
                    `;
                })
                .catch(error => {
                    detallesDiv.innerHTML = 'Error al cargar los datos.';
                    console.error('Fetch error:', error);
                });
        }
    </script>
</body>
</html>